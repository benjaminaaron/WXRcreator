<!doctype html>
<html>
    <head>
        <title>WXRcreator für kunstevent.net</title>
        <meta charset="UTF-8">
        <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="js/utils.js"></script>
        <script type="text/javascript" src="js/Template.js"></script> 
        <script type="text/javascript" src="js/Artist.js"></script>
        <script type="text/javascript" src="js/Event.js"></script>
        <script type="text/javascript" src="js/Venue.js"></script>

<!-- XML CONTAINER -->
    <!-- start -->
<script id="wxrStart" type="text/template"><?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:wp="http://wordpress.org/export/1.2/">
<channel>
<wp:wxr_version>1.2</wp:wxr_version></script>
    <!-- end -->
<script id="wxrEnd" type="text/template"></channel>
</rss></script>
    <!-- page -->
<script id="wxrPageTemplate" type="text/template">
<item>
  <title>$TITLE$</title>
  <content:encoded><![CDATA[$CONTENT$]]></content:encoded>
  <wp:post_id>$ID$</wp:post_id>
  <wp:post_name>$NAME$</wp:post_name>
  <wp:post_parent>$PARENT$</wp:post_parent>
  <wp:post_type>page</wp:post_type>
</item></script>

<!-- PAGE CONTENT -->
    <!-- beginning of nav table -->
<script id="pageNavTableStart" type="text/template"><h1 class="pageTitle">$PAGETITLE$</h1>
<table class="navTable">
<tbody>
<tr></script>
    <!-- end of nav table -->
<script id="pageNavTableEnd" type="text/template"><td class="navTableBackColumn">&lt;- <a title="$CATEGORY$" href="http://kunsteventmuenchen.wordpress.com/$CATEGORY_URL$">Zurück zur Übersicht $CATEGORY$</a></td>
</tr>
</tbody>
</table></script>
    <!-- one header -->
<script id="pageNavTableOneHeader" type="text/template"><td$FOCUSCOL$><a title="$SUBPAGE_TITLE$" href="http://kunsteventmuenchen.wordpress.com/$CATEGORY_URL$/$SUBPAGE_URL$/">$SUBPAGE_TITLE$</a></td>
</script>
    <!-- focus column -->
<script id="pageNavTableFocusColumn" type="text/template"> class="focusColumn"</script>

    <!-- embedding -->
<script id="embeddingSnippet" type="text/template"><td>
<div class="thumbnailContainer"><a title="$LANDINGPAGE_LONGTITLE$" href="http://kunsteventmuenchen.wordpress.com/$CATEGORY_URL$/$LANDINGPAGE_URL$"><img class="thumbnailPic" src="https://kunsteventmuenchen.files.wordpress.com/2015/10/artistpictureplaceholder_rect.jpg" alt="" width="100" height="100" /></a>
<a href="http://kunsteventmuenchen.wordpress.com/$CATEGORY_URL$/$LANDINGPAGE_URL$">$LANDINGPAGE_TITLE$</a></div></td>
</script>

<!-- CONTENT END -->

        <style>    
            html * {
                font-family: Georgia, serif;
            }
            br {
               display: block;
               margin: 10px 0px;
               content: '';
            }
            table {
                border-collapse: separate;
                border-spacing: 10px 30px;
            }
            td {
                padding: 10px 10px 10px 10px;
            }
            .tdArtist{
                border: 1.5px solid blue;
            }
            .tdEvent{
                border: 1.5px solid red;
            }
            .tdVenue{
                border: 1.5px solid green;
            }
        </style>
    </head>
    <body>

        <table border='0' align='center'>
            <tbody>
                <tr id='appendRow'>
                    <td>
                        Wilkommen zum WXR Creator für kunstevent.net
                    <td>
                </tr>
                <tr id='buttonRow'>
                    <td>
                        <div align='center'>
                            <input type='button' value='neuer Künstler' id='newArtistBtn'>
                            <input type='button' value='neues Event' id='newEventBtn'>
                            <input type='button' value='neuer Ausstellungsort' id='newVenueBtn'>
                        </div>
                    <td>
                </tr>
                <tr>
                    <td id='downloadBtnTd'>
                        <div align='center'>
                            <input type='button' value='Download' disabled=true id='downloadBtn'>
                        </div>
                    <td>
                </tr>
            </tbody>
        </table>
        
        <script>
        
            var wxrStart = $('#wxrStart').html();
            var wxrEnd = $('#wxrEnd').html();
            var wxrPageTemplate = $('#wxrPageTemplate').html();
            var pageNavTableStart = $('#pageNavTableStart').html();
            var pageNavTableEnd = $('#pageNavTableEnd').html();
            var pageNavTableOneHeader = $('#pageNavTableOneHeader').html();
            var pageNavTableFocusColumn = $('#pageNavTableFocusColumn').html();
            var embeddingSnippet = $('#embeddingSnippet').html();
            
            var appendRow = $('#appendRow');

            $('#newArtistBtn').click(function() {
                addTemplate(new Artist());
            });

            $('#newEventBtn').click(function() {
                addTemplate(new Event());
            });

            $('#newVenueBtn').click(function() {
                addTemplate(new Venue());
            });

            $('#downloadBtn').click(function() {
                downloadXML();
            });

            var currentMaxID = 1;
            var templates = [];

            function addTemplate(template){
                if(templates.length == 0)
                    $('#downloadBtn').prop('disabled', false);
                templates.push(template);
            };

            function downloadXML(){
                var wxrFile = wxrStart;

                for(var i = 0; i < templates.length; i ++)
                    wxrFile += templates[i].getWXRcontrib();

                wxrFile += wxrEnd;
                
                console.log(wxrFile);
                //download(wxrFile, "WordpressImport_" + getTimestamp() + ".xml");
                
                $('#downloadBtn').attr('disabled', true);                
                $('#buttonRow').remove();
                
                $('#downloadBtnTd').append($('<br/>'));
                $('#downloadBtnTd').append('Diese Datei <a target="_blank" href="https://kunsteventmuenchen.wordpress.com/wp-admin/admin.php?import=wordpress">hier</a> hochladen. Nach dem Import sind die neuen Seiten <a target="_blank" href="https://kunsteventmuenchen.wordpress.com/wp-admin/edit.php?post_status=draft&post_type=page">hier</a> zu finden.');   
            };

        </script>
    </body>
</html>
